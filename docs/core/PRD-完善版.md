# Cshine 产品需求文档 (PRD) v1.0

> **Let Your Ideas Shine. ✨**  
> 最后更新：2025年11月  
> 文档版本：v1.0

---

## 📋 目录

1. [产品概述](#1-产品概述)
2. [用户分析](#2-用户分析)
3. [核心功能详细说明](#3-核心功能详细说明)
4. [页面结构与交互设计](#4-页面结构与交互设计)
5. [技术架构详细方案](#5-技术架构详细方案)
6. [数据模型设计](#6-数据模型设计)
7. [API接口设计](#7-api接口设计)
8. [非功能性需求](#8-非功能性需求)
9. [开发计划与里程碑](#9-开发计划与里程碑)
10. [风险评估与应对](#10-风险评估与应对)
11. [成功指标（KPI）](#11-成功指标kpi)
12. [附录](#12-附录)

---

## 1. 产品概述

### 1.1 品牌定位

| 项目 | 内容 |
|------|------|
| **品牌名称** | Cshine |
| **含义** | 来自 Cosmos + Shine，寓意「让思考与灵感发光」 |
| **Slogan** | Let Your Ideas Shine. ✨ |
| **使命** | 帮助每个人轻松捕捉灵感与思维，永不遗忘任何闪现的想法 |
| **愿景** | 成为下一代智能语音记录与思维管理平台，让语音成为思考的自然延伸 |
| **产品调性** | 极简 · 智能 · 温度感 · 有灵气的科技产品 |

### 1.2 产品定义

Cshine 是一款 **AI 驱动的语音记录与会议纪要工具**，帮助用户即时捕捉灵感、自动生成摘要、并跨端同步所有想法。产品聚焦于移动端场景，通过微信小程序快速触达用户，未来扩展至独立 App。

### 1.3 产品价值

- **用户价值**：随时随地记录灵感，不再遗忘任何想法；自动整理会议内容，节省时间成本
- **商业价值**：切入个人知识管理赛道，未来可延伸至企业协作、付费订阅等商业模式
- **社会价值**：提升个人与团队生产力，让创意思维得以更好地沉淀与传播

### 1.4 竞品分析

| 竞品 | 优势 | 劣势 | 差异化策略 |
|------|------|------|-----------|
| **讯飞语记** | 语音识别准确率高，市场占有率大 | UI 较传统，AI 智能化程度低 | 更现代化的设计，更强的 AI 摘要能力 |
| **钉钉会议纪要** | 企业生态完善，团队协作功能强 | 偏重企业场景，个人用户体验一般 | 聚焦个人用户，更轻量的使用门槛 |
| **Notion AI** | 知识管理体系完善，AI 功能丰富 | 语音录入不是核心功能，价格较高 | 专注语音场景，提供更流畅的录音体验 |
| **Otter.ai** | 实时转写技术先进，英文支持好 | 中文支持较弱，国内访问受限 | 针对中文优化，本地化体验更好 |

**Cshine 的核心差异化**：
1. **极致的语音录入体验**：专为移动端设计的录音交互
2. **更智能的 AI 理解**：不只转文字，更懂语义和上下文
3. **轻量化产品形态**：微信小程序即用即走，无需下载安装
4. **温度感的设计语言**：有情感连接的产品体验

---

## 2. 用户分析

### 2.1 目标用户画像

#### 主要用户群体

**群体 1：知识工作者**
- **年龄**：25-40 岁
- **职业**：产品经理、设计师、创业者、自由职业者
- **痛点**：
  - 灵感瞬间出现，来不及打字记录
  - 会议后整理纪要耗时费力
  - 想法分散在各处，难以系统管理
- **使用场景**：
  - 通勤路上突然想到产品创意
  - 会议结束后需要快速整理要点
  - 深夜灵感闪现时的快速记录

**群体 2：学生与学习者**
- **年龄**：18-30 岁
- **身份**：大学生、研究生、终身学习者
- **痛点**：
  - 课堂笔记跟不上老师语速
  - 学习心得需要随时记录
  - 考研备考需要语音背诵复习
- **使用场景**：
  - 课堂录音后自动生成笔记大纲
  - 阅读时口述感想和总结
  - 小组讨论记录要点

**群体 3：创意工作者**
- **年龄**：22-45 岁
- **职业**：作家、编剧、内容创作者
- **痛点**：
  - 灵感稍纵即逝，需要即时捕捉
  - 创作素材散落各处难以整理
  - 语音表达比打字更自然流畅
- **使用场景**：
  - 构思小说情节时口述想法
  - 户外采风时记录见闻
  - 睡前记录创作灵感

### 2.2 用户需求层次

| 需求层次 | 具体需求 | 优先级 |
|---------|---------|--------|
| **基础需求** | 快速录音、准确转文字、安全存储 | P0 |
| **期望需求** | AI 自动摘要、智能分类、跨端同步 | P0 |
| **兴奋需求** | 语义搜索、思维导图生成、团队协作 | P1-P2 |

### 2.3 用户使用旅程

```
发现阶段 → 注册体验 → 首次录音 → AI 处理 → 查看结果 → 持续使用 → 形成习惯
   ↓          ↓          ↓          ↓          ↓          ↓          ↓
朋友推荐    微信登录    引导教程    等待反馈    惊喜体验    多场景用    每日必开
搜索下载    一键授权    首次录音    实时转写    智能摘要    数据积累    依赖产品
```

---

## 3. 核心功能详细说明

### 3.1 功能架构图

```
Cshine 小程序
│
├── 首页（闪记入口）
│   ├── 录音按钮（主交互）
│   ├── 历史记录列表
│   └── 智能分类标签
│
├── 闪记功能
│   ├── 实时录音
│   ├── 语音转文字
│   ├── AI 自动摘要
│   ├── 关键词提取
│   └── 手动编辑
│
├── 会议纪要
│   ├── 上传音频文件
│   ├── 识别说话人
│   ├── 要点提炼
│   ├── 行动项标注
│   └── 导出分享
│
├── 我的灵感库
│   ├── 智能分类
│   ├── 时间轴查看
│   ├── 标签管理
│   └── 收藏夹
│
├── 搜索功能
│   ├── 关键词搜索
│   ├── 语义搜索（V2.0）
│   └── 日期筛选
│
└── 个人中心
    ├── 用户信息
    ├── 使用统计
    ├── 设置选项
    └── 反馈帮助
```

### 3.2 功能详细说明

#### 功能 1：闪记（Voice Flash）⭐ 核心功能

**功能描述**  
用户通过长按录音按钮说出想法，系统自动完成语音识别和 AI 摘要生成。

**使用流程**
1. 用户进入首页，点击中央大按钮
2. 长按开始录音（震动反馈 + 波形动画）
3. 松开结束录音，上传至服务器
4. 实时显示转写文字（流式展示）
5. AI 生成摘要和关键词（3-5秒内完成）
6. 展示结果页面，支持编辑、删除、分享

**交互细节**
- **录音状态**：按钮变色 + 圆环呼吸动画 + 实时音量波形
- **取消录音**：上滑取消（类似微信语音）
- **时长限制**：单次录音最长 5 分钟，自动保存并提示
- **网络异常**：本地缓存录音，等待网络恢复后自动上传

**AI 处理逻辑**
- **转文字**：调用 ASR 引擎（优先使用讯飞/腾讯云）
- **摘要生成**：调用 LLM（GPT-4-turbo / 通义千问）
  - Prompt 模板：「将以下语音内容提炼为一句话摘要（15-30字），并提取3-5个关键词」
- **智能分类**：根据内容自动归类（工作、生活、学习、创意等）

**数据展示**
```
┌─────────────────────────────┐
│  🎙️ 闪记 #234               │
│  2025-11-07 14:23           │
├─────────────────────────────┤
│  💡 今天突然想到一个产品创意... │
│     可以做一个AI驱动的语音...   │
│                             │
│  📝 摘要：                   │
│  「语音记录工具结合AI生成摘要」 │
│                             │
│  🏷️ #产品创意 #AI #工具      │
└─────────────────────────────┘
```

**优先级**：P0（MVP 必备）

---

#### 功能 2：会议纪要（Smart Minutes）

**功能描述**  
用户上传会议录音文件，系统自动生成结构化会议纪要，包含参会人、讨论要点、行动项等。

**使用流程**
1. 点击「会议纪要」入口
2. 选择上传音频文件（支持 mp3/m4a/wav，最大 500MB）
3. 填写会议基本信息（主题、参会人、日期）
4. 提交处理（预计等待 2-10 分钟）
5. 推送通知完成，查看结构化纪要
6. 支持导出为 Markdown / PDF / 分享链接

**AI 处理能力**
- **说话人识别**：区分不同发言人（2-10人）
- **关键信息提取**：
  - 会议主题
  - 讨论要点（分段总结）
  - 决策事项
  - 行动项（Action Items）+ 负责人
  - 待解决问题
- **时间戳标注**：每个要点对应原音频时间点，可点击跳转收听

**纪要模板示例**
```markdown
# 产品评审会议纪要
**时间**：2025-11-07 10:00-11:30  
**参会人**：张三、李四、王五  
**记录人**：Cshine AI

## 会议概要
讨论了 V1.0 版本的功能优先级和开发排期...

## 讨论要点
### 1. 核心功能确定 [00:05:23]
- 张三：建议优先开发闪记功能...
- 李四：会议纪要功能是差异化竞争点...

### 2. 技术方案选型 [00:23:45]
- 王五：语音识别推荐使用讯飞 API...

## 决策事项
✅ 确定 MVP 功能范围：闪记 + 会议纪要  
✅ 技术栈：微信小程序 + FastAPI + PostgreSQL

## 行动项
- [ ] 张三：下周完成产品原型（截止 11/15）
- [ ] 李四：输出技术架构文档（截止 11/12）
- [ ] 王五：调研 ASR 服务商报价（截止 11/10）

## 待解决问题
❓ AI 摘要的成本控制方案？
❓ 数据存储的合规性审查？
```

**优先级**：P0（MVP 必备）

---

#### 功能 3：灵感聚合（Idea Hub）

**功能描述**  
自动整理所有闪记和会议记录，按主题、时间、标签等维度进行聚合展示。

**核心能力**
- **智能分类**：AI 自动识别内容类型（工作、生活、学习、创意、健康等）
- **主题聚类**：相似内容自动归档为同一主题
- **关键词云**：高频词汇可视化展示
- **时间轴视图**：按日期、周、月查看灵感演变

**页面布局**
- **顶部 Tab**：全部 / 工作 / 生活 / 学习 / 创意
- **主题卡片**：每个主题显示标题、条目数、最近更新时间
- **点击展开**：查看该主题下所有相关记录

**优先级**：P1（V1.0 后期优化）

---

#### 功能 4：智能搜索（AI Recall）

**功能描述**  
支持关键词搜索和语义搜索，快速找到历史记录。

**搜索能力**
- **关键词搜索**：标题、正文、标签精确匹配
- **语义搜索（V2.0）**：理解用户意图，即使用词不同也能找到相关内容
  - 示例：搜索「如何提升工作效率」，能匹配到「时间管理技巧」的记录
- **日期筛选**：按时间范围过滤
- **标签筛选**：多标签组合查询

**搜索结果展示**
- 高亮匹配关键词
- 显示相关度评分
- 支持按时间 / 相关度排序

**优先级**：P0（关键词搜索）+ P1（语义搜索）

---

#### 功能 5：跨端同步

**功能描述**  
微信小程序与未来的独立 App 之间实时同步数据。

**同步策略**
- **实时同步**：创建、编辑、删除操作立即同步
- **增量同步**：只传输变更数据，节省流量
- **冲突处理**：以最后编辑时间为准，保留冲突版本供用户选择

**技术实现**
- WebSocket 长连接保持实时性
- 本地 SQLite 缓存 + 云端 PostgreSQL
- 离线编辑队列，联网后自动上传

**优先级**：P1（V1.0 支持微信小程序，V2.0 扩展 App）

---

## 4. 页面结构与交互设计

### 4.1 页面架构

```
启动页（Splash）
    ↓
首页（Home）
    ├─→ 录音页（Record）→ 结果页（Result）→ 详情页（Detail）
    ├─→ 会议纪要上传页（Upload）→ 处理中（Processing）→ 纪要详情（Minutes）
    ├─→ 灵感库（Library）→ 主题详情（Theme Detail）
    ├─→ 搜索页（Search）→ 搜索结果（Search Result）
    └─→ 我的（Profile）
            ├─→ 设置（Settings）
            ├─→ 使用统计（Statistics）
            └─→ 帮助反馈（Help）
```

### 4.2 关键页面设计

#### 页面 1：首页（Home）

**布局结构**
```
┌───────────────────────────┐
│   Cshine            [?]   │  ← 顶部导航
├───────────────────────────┤
│                           │
│      [🎙️ 按住说话]        │  ← 核心录音按钮（居中）
│                           │
│    今天已记录 3 条灵感      │  ← 统计信息
│                           │
├───────────────────────────┤
│  最近记录 ▼               │  ← 筛选器
├───────────────────────────┤
│ 💡 产品创意：AI语音工具    │  ← 记录卡片
│ 5分钟前 · #工作           │
├───────────────────────────┤
│ 📝 读书笔记：认知觉醒      │
│ 1小时前 · #学习           │
├───────────────────────────┤
│ 🎯 每周目标：完成PRD文档   │
│ 昨天 · #计划              │
└───────────────────────────┘
│  [闪记] [纪要] [灵感] [我的] │  ← 底部导航
└───────────────────────────┘
```

**交互说明**
- 录音按钮：长按录音，上滑取消
- 记录卡片：左滑显示删除/置顶操作
- 下拉刷新：加载最新数据
- 上滑加载更多

---

#### 页面 2：录音页（Record）

**布局结构**
```
┌───────────────────────────┐
│         [X] 取消          │
├───────────────────────────┤
│                           │
│      ╱╲╱╲╱╲╱╲╱╲          │  ← 实时音量波形
│     ╱  ╲  ╱  ╲  ╱        │
│                           │
│         00:23             │  ← 录音时长
│                           │
│    [🔴 正在录音...]        │  ← 状态提示
│                           │
│      ↑ 上滑取消           │  ← 手势提示
└───────────────────────────┘
```

**动效设计**
- 录音按钮：呼吸动画（缩放 0.95-1.05，循环）
- 波形动画：根据音量实时变化
- 震动反馈：开始录音时震动 10ms

---

#### 页面 3：结果页（Result）

**布局结构**
```
┌───────────────────────────┐
│   [<]  闪记详情   [编辑]   │
├───────────────────────────┤
│  2025-11-07 14:23         │
│  录音时长：23秒            │
├───────────────────────────┤
│  原文 ▼                   │
│  今天突然想到一个产品创意， │
│  可以做一个AI驱动的语音记录 │
│  工具，帮助用户随时捕捉灵感。│
│  结合大模型自动生成摘要...  │
├───────────────────────────┤
│  📝 AI 摘要               │
│  「语音记录工具结合AI生成摘  │
│   要，面向知识工作者」      │
├───────────────────────────┤
│  🏷️ 智能标签              │
│  #产品创意  #AI  #工具     │
├───────────────────────────┤
│  📂 分类：工作             │
│  ⭐ 重要程度：★★★☆☆       │
├───────────────────────────┤
│  [🗑️ 删除]  [🔗 分享]     │
└───────────────────────────┘
```

---

### 4.3 交互规范

| 交互元素 | 规范说明 |
|---------|---------|
| **按钮点击** | 触发震动反馈（10ms），视觉按下效果（缩放 0.95） |
| **加载状态** | 显示 Loading 动画，配合文案「AI 正在思考...」 |
| **错误提示** | Toast 提示 + 红色图标，3秒自动消失 |
| **成功反馈** | 绿色勾号动画 + 轻微震动 |
| **滑动操作** | 左滑删除、右滑置顶，滑动距离 >60px 触发 |

---

## 5. 技术架构详细方案

### 5.1 整体架构图

```
┌─────────────────────────────────────────────────────────┐
│                       前端层 Frontend                     │
│  ┌────────────────┐              ┌─────────────────┐    │
│  │  微信小程序      │              │  Flutter App    │    │
│  │  WXML + WXSS   │              │  (V2.0 规划)    │    │
│  └────────┬───────┘              └────────┬────────┘    │
└───────────┼──────────────────────────────┼──────────────┘
            │          HTTPS REST API       │
            │          WebSocket (同步)      │
┌───────────┼──────────────────────────────┼──────────────┐
│           ▼                              ▼              │
│  ┌──────────────────────────────────────────────────┐  │
│  │            API 网关 (Nginx + Kong)                │  │
│  │  · 限流 / 鉴权 / 日志 / 负载均衡                   │  │
│  └────────────────────┬─────────────────────────────┘  │
│                       ▼                                 │
│  ┌──────────────────────────────────────────────────┐  │
│  │              后端服务层 Backend                    │  │
│  │                                                    │  │
│  │  ┌─────────────┐  ┌──────────────┐  ┌─────────┐  │  │
│  │  │  FastAPI    │  │    Celery    │  │  Redis  │  │  │
│  │  │  主服务      │  │   异步任务    │  │  缓存   │  │  │
│  │  └──────┬──────┘  └──────┬───────┘  └────┬────┘  │  │
│  │         │                 │               │        │  │
│  │         └─────────────────┴───────────────┘        │  │
│  └────────────────────┬─────────────────────────────┘  │
│                       ▼                                 │
│  ┌──────────────────────────────────────────────────┐  │
│  │               AI 服务层 AI Services               │  │
│  │                                                    │  │
│  │  ┌──────────────┐         ┌───────────────────┐  │  │
│  │  │  ASR 语音识别 │         │   LLM 语义处理     │  │  │
│  │  │              │         │                    │  │  │
│  │  │  · 讯飞      │         │  · GPT-4-turbo    │  │  │
│  │  │  · 腾讯云    │         │  · 通义千问        │  │  │
│  │  │  · FunASR    │         │  · Moonshot       │  │  │
│  │  └──────────────┘         └───────────────────┘  │  │
│  └────────────────────┬─────────────────────────────┘  │
│                       ▼                                 │
│  ┌──────────────────────────────────────────────────┐  │
│  │             数据存储层 Data Layer                  │  │
│  │                                                    │  │
│  │  ┌──────────────┐  ┌───────────────────────────┐  │  │
│  │  │ PostgreSQL   │  │  阿里云 OSS / 腾讯云 COS   │  │  │
│  │  │ 结构化数据    │  │   音频文件存储             │  │  │
│  │  └──────────────┘  └───────────────────────────┘  │  │
│  └──────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────┘
```

### 5.2 技术栈选型

#### 前端技术栈

| 技术 | 说明 | 选型理由 |
|------|------|---------|
| **微信小程序** | 原生框架 | 快速触达用户，无需下载安装 |
| **WeUI** | UI 组件库 | 符合微信设计规范，开发效率高 |
| **云开发 / 自建后端** | 部署方案 | V1.0 可用云开发快速迭代，后续迁移自建后端 |

#### 后端技术栈

| 技术 | 版本 | 说明 |
|------|------|------|
| **Python** | 3.11+ | 主开发语言 |
| **FastAPI** | 0.104+ | 高性能 Web 框架，支持异步 |
| **Celery** | 5.3+ | 异步任务队列（处理音频转写） |
| **Redis** | 7.0+ | 缓存 + 消息队列 |
| **PostgreSQL** | 15+ | 主数据库，支持向量搜索（pgvector） |
| **SQLAlchemy** | 2.0+ | ORM 框架 |
| **Alembic** | - | 数据库迁移工具 |

#### AI 服务

| 服务 | 提供商 | 用途 | 成本估算 |
|------|--------|------|---------|
| **ASR 语音识别** | 讯飞 / 腾讯云 | 语音转文字 | 约 0.5-1 元/小时 |
| **LLM 大模型** | GPT-4-turbo / 通义千问 | 摘要生成、关键词提取 | 约 0.01-0.05 元/次 |
| **向量数据库** | PostgreSQL + pgvector / Pinecone | 语义搜索（V2.0） | 自建或 $0.1/100万向量 |

#### 基础设施

| 服务 | 说明 |
|------|------|
| **服务器** | 阿里云 / 腾讯云 ECS（2核4G起步） |
| **CDN** | 加速音频文件访问 |
| **OSS** | 对象存储，存放音频文件 |
| **监控** | Sentry（错误追踪）+ Grafana（性能监控） |

### 5.3 数据流程

#### 闪记流程

```
用户录音
  ↓
微信小程序上传音频（wx.uploadFile）
  ↓
后端接收文件 → 保存到 OSS → 返回 task_id
  ↓
Celery 异步任务启动
  ├─→ 调用 ASR 接口转文字
  ├─→ 调用 LLM 生成摘要
  └─→ 提取关键词、自动分类
  ↓
结果写入数据库 → 更新任务状态
  ↓
前端轮询 / WebSocket 推送结果
  ↓
用户查看结果页面
```

#### 会议纪要流程

```
用户上传音频文件（最大 500MB）
  ↓
后端分片上传 → 保存到 OSS
  ↓
Celery 长时任务处理
  ├─→ 音频预处理（降噪、格式转换）
  ├─→ 说话人识别（Diarization）
  ├─→ 分段转文字（ASR）
  ├─→ LLM 提取会议要点、行动项
  └─→ 生成结构化 Markdown
  ↓
结果存储 + 微信服务号推送通知
  ↓
用户查看详细纪要
```

---

## 6. 数据模型设计

### 6.1 数据库设计

#### 表 1：用户表（users）

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | UUID | 用户唯一标识 | PRIMARY KEY |
| openid | VARCHAR(100) | 微信 openid | UNIQUE, NOT NULL |
| unionid | VARCHAR(100) | 微信 unionid（跨平台） | UNIQUE |
| nickname | VARCHAR(50) | 昵称 | |
| avatar | TEXT | 头像 URL | |
| created_at | TIMESTAMP | 注册时间 | NOT NULL |
| last_login | TIMESTAMP | 最后登录时间 | |
| is_active | BOOLEAN | 是否激活 | DEFAULT TRUE |
| subscription_tier | ENUM | 订阅等级（免费/付费） | DEFAULT 'free' |

#### 表 2：闪记记录表（flashes）

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | UUID | 记录唯一标识 | PRIMARY KEY |
| user_id | UUID | 所属用户 | FOREIGN KEY → users.id |
| title | VARCHAR(100) | 标题（自动生成或手动编辑） | |
| content | TEXT | 转写文字内容 | NOT NULL |
| summary | TEXT | AI 生成摘要 | |
| keywords | JSONB | 关键词数组 | |
| category | VARCHAR(20) | 分类（工作/生活/学习等） | |
| audio_url | TEXT | 音频文件 URL | |
| audio_duration | INTEGER | 音频时长（秒） | |
| is_favorite | BOOLEAN | 是否收藏 | DEFAULT FALSE |
| created_at | TIMESTAMP | 创建时间 | NOT NULL |
| updated_at | TIMESTAMP | 更新时间 | |
| embedding | VECTOR(1536) | 语义向量（V2.0 用于语义搜索） | |

#### 表 3：会议纪要表（meetings）

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | UUID | 会议唯一标识 | PRIMARY KEY |
| user_id | UUID | 创建者 | FOREIGN KEY → users.id |
| title | VARCHAR(200) | 会议主题 | NOT NULL |
| participants | JSONB | 参会人列表 | |
| meeting_date | DATE | 会议日期 | |
| audio_url | TEXT | 音频文件 URL | |
| audio_duration | INTEGER | 音频时长（秒） | |
| transcript | TEXT | 完整转写文本 | |
| summary | TEXT | 会议摘要 | |
| key_points | JSONB | 讨论要点（结构化） | |
| action_items | JSONB | 行动项列表 | |
| created_at | TIMESTAMP | 创建时间 | NOT NULL |
| status | ENUM | 处理状态（待处理/处理中/已完成） | DEFAULT 'pending' |

#### 表 4：标签表（tags）

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | UUID | 标签唯一标识 | PRIMARY KEY |
| user_id | UUID | 所属用户 | FOREIGN KEY → users.id |
| name | VARCHAR(20) | 标签名称 | NOT NULL |
| color | VARCHAR(7) | 标签颜色（HEX） | |
| usage_count | INTEGER | 使用次数 | DEFAULT 0 |
| created_at | TIMESTAMP | 创建时间 | |

#### 表 5：闪记-标签关联表（flash_tags）

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| flash_id | UUID | 闪记 ID | FOREIGN KEY → flashes.id |
| tag_id | UUID | 标签 ID | FOREIGN KEY → tags.id |
| created_at | TIMESTAMP | 关联时间 | |

PRIMARY KEY (flash_id, tag_id)

### 6.2 数据安全

- **加密存储**：用户敏感信息加密（AES-256）
- **访问控制**：每个用户只能访问自己的数据
- **数据备份**：每日全量备份 + 实时增量备份
- **合规性**：遵守《个人信息保护法》，提供数据导出和删除功能

---

## 7. API 接口设计

### 7.1 认证接口

#### POST /api/v1/auth/login
**描述**：微信小程序登录

**请求参数**
```json
{
  "code": "微信登录凭证",
  "userInfo": {
    "nickname": "用户昵称",
    "avatar": "头像URL"
  }
}
```

**响应**
```json
{
  "code": 200,
  "message": "登录成功",
  "data": {
    "token": "JWT Token",
    "user_id": "uuid",
    "is_new_user": true
  }
}
```

---

### 7.2 闪记接口

#### POST /api/v1/flash/create
**描述**：创建闪记（上传音频）

**请求参数**（multipart/form-data）
```
audio: 音频文件（必填）
category: 分类（可选）
```

**响应**
```json
{
  "code": 200,
  "message": "上传成功",
  "data": {
    "flash_id": "uuid",
    "task_id": "celery-task-id",
    "status": "processing"
  }
}
```

---

#### GET /api/v1/flash/{flash_id}
**描述**：获取闪记详情

**响应**
```json
{
  "code": 200,
  "data": {
    "id": "uuid",
    "title": "产品创意",
    "content": "今天突然想到...",
    "summary": "AI生成的摘要",
    "keywords": ["产品", "AI", "创意"],
    "category": "工作",
    "audio_url": "https://...",
    "audio_duration": 23,
    "created_at": "2025-11-07T14:23:00Z",
    "is_favorite": false
  }
}
```

---

#### GET /api/v1/flash/list
**描述**：获取闪记列表

**请求参数**（Query）
```
page: 页码（默认1）
page_size: 每页数量（默认20）
category: 分类筛选（可选）
keyword: 搜索关键词（可选）
```

**响应**
```json
{
  "code": 200,
  "data": {
    "total": 156,
    "page": 1,
    "page_size": 20,
    "items": [
      {
        "id": "uuid",
        "title": "产品创意",
        "summary": "摘要内容",
        "category": "工作",
        "created_at": "2025-11-07T14:23:00Z"
      }
    ]
  }
}
```

---

### 7.3 会议纪要接口

#### POST /api/v1/meeting/create
**描述**：上传会议音频

**请求参数**（multipart/form-data）
```
audio: 音频文件（必填）
title: 会议主题（必填）
meeting_date: 会议日期（可选）
participants: 参会人（JSON数组，可选）
```

**响应**
```json
{
  "code": 200,
  "message": "上传成功，预计处理时间5-10分钟",
  "data": {
    "meeting_id": "uuid",
    "task_id": "celery-task-id"
  }
}
```

---

#### GET /api/v1/meeting/{meeting_id}
**描述**：获取会议纪要详情

**响应**
```json
{
  "code": 200,
  "data": {
    "id": "uuid",
    "title": "产品评审会议",
    "meeting_date": "2025-11-07",
    "participants": ["张三", "李四"],
    "summary": "会议摘要",
    "key_points": [
      {
        "timestamp": "00:05:23",
        "speaker": "张三",
        "content": "讨论要点1"
      }
    ],
    "action_items": [
      {
        "content": "完成PRD文档",
        "assignee": "张三",
        "deadline": "2025-11-15"
      }
    ],
    "status": "completed",
    "created_at": "2025-11-07T10:00:00Z"
  }
}
```

---

### 7.4 搜索接口

#### GET /api/v1/search
**描述**：搜索闪记和会议记录

**请求参数**
```
q: 搜索关键词（必填）
type: 搜索类型（flash/meeting/all，默认all）
page: 页码
```

**响应**
```json
{
  "code": 200,
  "data": {
    "results": [
      {
        "id": "uuid",
        "type": "flash",
        "title": "产品创意",
        "highlight": "...AI驱动的<em>语音</em>记录...",
        "score": 0.95,
        "created_at": "2025-11-07T14:23:00Z"
      }
    ],
    "total": 12
  }
}
```

---

### 7.5 错误码规范

| 错误码 | 说明 |
|--------|------|
| 200 | 成功 |
| 400 | 请求参数错误 |
| 401 | 未授权（Token 失效） |
| 403 | 无权限访问 |
| 404 | 资源不存在 |
| 429 | 请求过于频繁 |
| 500 | 服务器内部错误 |
| 503 | 服务暂时不可用（AI 服务异常） |

---

## 8. 非功能性需求

### 8.1 性能要求

| 指标 | 目标值 | 说明 |
|------|--------|------|
| **首页加载时间** | < 1 秒 | 首屏渲染完成 |
| **录音响应时间** | < 200ms | 点击录音到开始录音 |
| **ASR 转写速度** | < 5 秒 | 1 分钟音频完成转写 |
| **AI 摘要生成** | < 3 秒 | 单条闪记摘要生成 |
| **搜索响应时间** | < 500ms | 返回搜索结果 |
| **并发用户数** | 1000+ | 支持同时在线用户 |

### 8.2 可用性要求

- **系统可用性**：≥ 99.5%（每月宕机时间 < 3.6 小时）
- **数据持久性**：≥ 99.99%（不丢失用户数据）
- **容灾备份**：支持跨地域备份，RTO < 1 小时

### 8.3 安全性要求

- **数据传输**：全站 HTTPS 加密
- **身份认证**：JWT Token + 微信登录
- **API 限流**：单用户 100 次/分钟
- **敏感信息**：音频文件加密存储，访问需签名
- **隐私合规**：用户可随时导出和删除数据

### 8.4 可扩展性

- **微服务化**：后续可拆分为独立服务（ASR 服务、LLM 服务）
- **水平扩展**：支持多实例部署 + 负载均衡
- **数据库分片**：用户量增长后支持分库分表

### 8.5 兼容性

- **微信小程序**：支持微信基础库 2.10.0+
- **操作系统**：iOS 10+、Android 5.0+
- **网络环境**：4G/5G/Wi-Fi，弱网环境降级处理

---

## 9. 开发计划与里程碑

### 9.1 项目阶段

#### Phase 1：MVP 开发（预计 6 周）

| 周次 | 任务 | 交付物 | 负责人 |
|------|------|--------|--------|
| **Week 1** | 需求梳理 & 技术调研 | PRD 文档、技术方案 | 产品 + 技术 |
| **Week 2-3** | 小程序前端开发 | 完成首页、录音、详情页 | 前端 |
| **Week 3-4** | 后端接口开发 | 用户登录、闪记 CRUD | 后端 |
| **Week 4-5** | AI 服务集成 | ASR + LLM 调通 | 后端 + AI |
| **Week 5** | 联调测试 | 端到端功能打通 | 全员 |
| **Week 6** | 内测 & 优化 | 修复 Bug，性能优化 | 全员 |

**里程碑 M1**：完成核心闪记功能，可内部使用

---

#### Phase 2：功能完善（预计 4 周）

| 周次 | 任务 | 交付物 |
|------|------|--------|
| **Week 7-8** | 会议纪要功能 | 支持上传音频文件，生成结构化纪要 |
| **Week 9** | 灵感库 & 搜索 | 智能分类、关键词搜索 |
| **Week 10** | 用户体验优化 | 引导教程、分享功能、统计看板 |

**里程碑 M2**：完成 V1.0 全部功能，准备上线

---

#### Phase 3：上线运营（预计 2 周）

| 周次 | 任务 | 交付物 |
|------|------|--------|
| **Week 11** | 小程序审核 | 提交微信审核，准备运营物料 |
| **Week 12** | 灰度发布 | 邀请种子用户体验，收集反馈 |

**里程碑 M3**：正式上线，开始获取用户

---

### 9.2 后续规划（V2.0 - V5.0）

| 版本 | 时间 | 核心功能 | 目标 |
|------|------|---------|------|
| **V2.0** | 上线后 3-6 个月 | 语义搜索、数据统计可视化 | DAU 达到 1000+ |
| **V3.0** | 6-12 个月 | 团队协作、多人共享会议 | 拓展 B 端市场 |
| **V4.0** | 12-18 个月 | 实时转写、语音流式识别 | 技术领先性 |
| **V5.0** | 18-24 个月 | 灵感知识库、思维导图生成 | 知识管理平台 |

---

## 10. 风险评估与应对

### 10.1 技术风险

| 风险 | 影响 | 概率 | 应对措施 |
|------|------|------|---------|
| **ASR 识别准确率低** | 用户体验差，流失率高 | 中 | 多家服务商对比测试，选择最优方案；提供手动编辑功能 |
| **LLM 成本过高** | 运营成本不可控 | 高 | 使用国产大模型降低成本；对免费用户限制调用次数 |
| **音频上传失败** | 功能不可用 | 中 | 断点续传 + 本地缓存；网络异常提示 |
| **并发量过大** | 服务器宕机 | 低 | 弹性伸缩 + CDN 加速；限流策略 |
| **第三方 API 不稳定** | 影响核心功能 | 中 | 主备方案切换；降级处理（保存原音频，延后处理） |

### 10.2 产品风险

| 风险 | 影响 | 概率 | 应对措施 |
|------|------|------|---------|
| **用户需求不匹配** | 产品方向错误 | 中 | 早期小范围内测，快速迭代；用户访谈 |
| **竞品抄袭** | 市场份额被抢占 | 高 | 持续优化体验，建立品牌认知；技术壁垒 |
| **用户留存率低** | 无法形成习惯 | 高 | 提供每日提醒、数据统计激励；社交分享功能 |
| **变现模式不清晰** | 商业化困难 | 中 | 先做用户量，再探索订阅制/企业版 |

### 10.3 合规风险

| 风险 | 影响 | 概率 | 应对措施 |
|------|------|------|---------|
| **隐私合规问题** | 被下架或罚款 | 低 | 严格遵守《个人信息保护法》；用户协议和隐私政策 |
| **内容审核** | 敏感内容传播 | 中 | 接入微信内容安全 API；敏感词过滤 |
| **小程序审核不通过** | 延迟上线 | 中 | 提前沟通审核规则；准备完整资质 |

---

## 11. 成功指标（KPI）

### 11.1 产品指标

| 指标 | V1.0 目标 | V2.0 目标 | 说明 |
|------|-----------|-----------|------|
| **注册用户数** | 5,000 | 50,000 | 累计注册用户 |
| **DAU（日活）** | 500 | 5,000 | 每日活跃用户 |
| **用户留存率** | D7 > 30% | D7 > 40% | 7 日留存率 |
| **日均录音次数** | 1,500 | 15,000 | 核心功能使用频率 |
| **NPS（净推荐值）** | > 40 | > 50 | 用户满意度 |

### 11.2 技术指标

| 指标 | 目标值 | 监控方式 |
|------|--------|---------|
| **API 可用性** | > 99.5% | Grafana 实时监控 |
| **P95 响应时间** | < 2 秒 | 后端日志分析 |
| **错误率** | < 1% | Sentry 错误追踪 |
| **ASR 准确率** | > 95% | 人工抽样验证 |

### 11.3 商业指标（V2.0+）

| 指标 | 目标 | 说明 |
|------|------|------|
| **付费转化率** | > 5% | 免费用户转付费会员 |
| **月度 ARPU** | ¥30 | 每用户平均收入 |
| **CAC（获客成本）** | < ¥50 | 单个用户获取成本 |
| **LTV / CAC** | > 3 | 用户生命周期价值与获客成本比 |

---

## 12. 附录

### 12.1 视觉设计规范

#### 色彩系统

**主色调**
- **天蓝色（Primary）**：`#4A6FE8` - 代表灵感、创新
- **宇宙紫（Secondary）**：`#7B61FF` - 代表思考、深度

**辅助色**
- **白色（Background）**：`#FFFFFF`
- **深灰（Text）**：`#1C1C1E`
- **浅灰（Border）**：`#E5E5E5`

**功能色**
- **成功绿**：`#34C759`
- **警告橙**：`#FF9500`
- **错误红**：`#FF3B30`

#### 字体规范

| 场景 | 字体 | 字号 | 字重 |
|------|------|------|------|
| **大标题** | HarmonyOS Sans Bold | 32px | Bold |
| **标题** | HarmonyOS Sans | 20px | Medium |
| **正文** | PingFang SC | 16px | Regular |
| **辅助文字** | PingFang SC | 14px | Regular |
| **说明文字** | PingFang SC | 12px | Regular |

#### 间距规范

- **页面边距**：32rpx（16px）
- **元素间距**：24rpx（12px）
- **卡片内边距**：32rpx
- **圆角半径**：
  - 小圆角：8rpx（按钮、标签）
  - 中圆角：16rpx（卡片）
  - 大圆角：24rpx（弹窗）

---

### 12.2 Logo 设计建议

**设计方向**
1. **字母 C + 声波**：将 "C" 融合声波纹理，体现语音属性
2. **闪光粒子**：圆形粒子聚合成 "C"，象征灵感闪现
3. **渐变效果**：使用天蓝到宇宙紫的渐变，增加科技感

**参考示意**（文字描述）
```
     ╱╲╱╲
   ╱      ╲
  ╱   C    ╲  ← 圆形轮廓
 │    ╱╲╱╲  │  ← 内部声波纹理
  ╲        ╱
   ╲______╱

颜色：#4A6FE8 → #7B61FF 渐变
```

---

### 12.3 关键术语表

| 术语 | 英文 | 说明 |
|------|------|------|
| **闪记** | Voice Flash | 核心功能，快速录音 + AI 摘要 |
| **会议纪要** | Smart Minutes | 上传会议录音，自动生成纪要 |
| **灵感库** | Idea Hub | 所有记录的聚合管理 |
| **语义搜索** | Semantic Search | 基于向量的智能搜索 |
| **ASR** | Automatic Speech Recognition | 自动语音识别 |
| **LLM** | Large Language Model | 大语言模型 |

---

### 12.4 参考资料

- [微信小程序开发文档](https://developers.weixin.qq.com/miniprogram/dev/framework/)
- [FastAPI 官方文档](https://fastapi.tiangolo.com/)
- [OpenAI API 文档](https://platform.openai.com/docs/)
- [讯飞开放平台](https://www.xfyun.cn/)
- [阿里云 OSS 文档](https://help.aliyun.com/product/31815.html)

---

### 12.5 更新日志

| 版本 | 日期 | 更新内容 | 作者 |
|------|------|---------|------|
| v1.0 | 2025-11-07 | 完整 PRD 初稿 | AI Assistant |

---

## 结语

Cshine 致力于成为新一代智能语音记录工具，让每个人的灵感都能被轻松捕捉、理解和点亮。

**Let Your Ideas Shine. ✨**

---

*本文档由 Cshine 产品团队维护，如有疑问请联系产品负责人。*

