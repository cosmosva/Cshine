<!--ä¼šè®®çºªè¦è¯¦æƒ…é¡µ-->
<view class="meeting-detail-page">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <navigation-bar title="ä¼šè®®è¯¦æƒ…" showBack="{{true}}" rightText="â€¢â€¢â€¢" bind:rightClick="showActionMenu" />

  <!-- åŠ è½½ä¸­ -->
  <view class="loading-state" wx:if="{{loading}}">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- ä¸»å†…å®¹ -->
  <view class="page-content" wx:if="{{!loading && meeting}}">
    <!-- ä¼šè®®å¤´éƒ¨ -->
    <view class="meeting-header">
      <view class="header-bg"></view>
      <view class="header-content">
        <view class="meeting-title">{{meeting.title}}</view>
        
        <view class="meeting-meta">
          <text class="meta-item" wx:if="{{meeting.meeting_date}}">
            ğŸ“… {{formatTime(meeting.meeting_date)}}
          </text>
          <text class="meta-item" wx:if="{{meeting.audio_duration}}">
            â±ï¸ {{formatDuration(meeting.audio_duration)}}
          </text>
          <text class="meta-item" wx:if="{{meeting.participants && meeting.participants.length > 0}}">
            ğŸ‘¥ {{meeting.participants.join(', ')}}
          </text>
        </view>

        <!-- éŸ³é¢‘æ’­æ”¾å™¨ -->
        <view class="audio-player" wx:if="{{meeting.audio_url}}">
          <view class="play-btn" bindtap="toggleAudio">
            <text class="icon">{{isPlaying ? 'â¸ï¸' : 'â–¶ï¸'}}</text>
          </view>
          <view class="audio-info">
            <view class="audio-progress">
              <view class="progress-bar">
                <view class="progress-fill" style="width: {{(currentTime / duration) * 100}}%;"></view>
              </view>
            </view>
            <view class="audio-time">
              <text>{{formatDuration(currentTime)}}</text>
              <text>{{formatDuration(duration || meeting.audio_duration)}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- Tab å¯¼èˆª -->
    <view class="tab-nav">
      <view 
        class="tab-item {{activeTab === item.id ? 'active' : ''}}"
        wx:for="{{tabs}}"
        wx:key="id"
        data-tab="{{item.id}}"
        bindtap="switchTab"
      >
        {{item.name}}
      </view>
    </view>

    <!-- Tab å†…å®¹ -->
    <scroll-view class="tab-content" scroll-y enhanced show-scrollbar="{{false}}">
      <!-- æ‘˜è¦ -->
      <view class="content-section" wx:if="{{activeTab === 'summary'}}">
        <view class="section-card">
          <view class="card-title">ğŸ“ ä¼šè®®æ‘˜è¦</view>
          <view class="summary-text">
            {{meeting.summary || 'æš‚æ— æ‘˜è¦'}}
          </view>
        </view>
      </view>

      <!-- è¦ç‚¹ -->
      <view class="content-section" wx:if="{{activeTab === 'keyPoints'}}">
        <view class="key-points-list" wx:if="{{meeting.key_points && meeting.key_points.length > 0}}">
          <view class="point-card" wx:for="{{meeting.key_points}}" wx:key="index">
            <view class="point-header">
              <text class="point-timestamp">{{item.timestamp}}</text>
              <text class="point-speaker" wx:if="{{item.speaker}}">{{item.speaker}}</text>
            </view>
            <view class="point-topic">{{item.topic}}</view>
            <view class="point-content">{{item.content}}</view>
          </view>
        </view>
        <view class="empty-tip" wx:else>
          æš‚æ— è¦ç‚¹ä¿¡æ¯
        </view>
      </view>

      <!-- è¡ŒåŠ¨é¡¹ -->
      <view class="content-section" wx:if="{{activeTab === 'actions'}}">
        <view class="action-list" wx:if="{{meeting.action_items && meeting.action_items.length > 0}}">
          <view class="action-card" wx:for="{{meeting.action_items}}" wx:key="index">
            <view class="action-header">
              <view class="action-checkbox {{item.status === 'completed' ? 'checked' : ''}}">
                {{item.status === 'completed' ? 'âœ“' : ''}}
              </view>
              <view class="action-priority priority-{{item.priority}}">
                {{item.priority === 'high' ? 'é«˜' : item.priority === 'low' ? 'ä½' : 'ä¸­'}}
              </view>
            </view>
            <view class="action-content">{{item.content}}</view>
            <view class="action-footer">
              <text class="action-assignee" wx:if="{{item.assignee}}">ğŸ‘¤ {{item.assignee}}</text>
              <text class="action-deadline" wx:if="{{item.deadline}}">ğŸ“… {{item.deadline}}</text>
            </view>
          </view>
        </view>
        <view class="empty-tip" wx:else>
          æš‚æ— è¡ŒåŠ¨é¡¹
        </view>
      </view>

      <!-- å…¨æ–‡ -->
      <view class="content-section" wx:if="{{activeTab === 'transcript'}}">
        <view class="section-card">
          <view class="card-title">ğŸ“„ ä¼šè®®å…¨æ–‡</view>
          <view class="transcript-text">
            {{meeting.transcript || 'æš‚æ— è½¬å†™æ–‡æœ¬'}}
          </view>
        </view>
      </view>
    </scroll-view>
  </view>
</view>

